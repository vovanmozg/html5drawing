<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Космический корабль</title>
    <style>
        canvas {
            display: block;
            background-color: #000;
            margin: 0 auto;
        }
    </style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    // Установка размеров canvas
    canvas.width = 800;
    canvas.height = 600;

    // Корабль
    const ship = {
      x: 50,
      y: canvas.height / 2,
      width: 50,
      height: 30,
      speed: 5,
      moveUp: false,
      moveDown: false
    };

    // Пули
    const bullets = [];
    const bulletSpeed = 10;

    // Фон
    let backgroundX = 0;
    const backgroundSpeed = 2;

    // Текстура земли
    let groundY = canvas.height - 50; // Позиция земли от низа канваса
    const groundHeight = 50; // Высота земли

    // Враги
    const enemies = [];
    const enemySpeed = 2;

    function drawShip() {
      ctx.fillStyle = 'white';
      ctx.fillRect(ship.x, ship.y, ship.width, ship.height);
    }

    function drawBullet(bullet) {
      ctx.fillStyle = 'yellow';
      ctx.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
    }

    function updateBackground() {
      backgroundX -= backgroundSpeed;
      if (backgroundX <= -canvas.width) {
        backgroundX = 0;
      }
    }

    function updateBullets() {
      for (let i = 0; i < bullets.length; i++) {
        bullets[i].x += bulletSpeed;
        // Удаляем пулю, если она вышла за пределы канваса
        if (bullets[i].x > canvas.width) {
          bullets.splice(i, 1);
          i--;
        }
      }
    }

    // Формы на земле
    const groundForms = [];
    for (let i = 0; i < 20; i++) { // 20 форм на земле
      let x = Math.random() * canvas.width;
      let y = groundY + Math.random() * groundHeight / 2;
      let w = 10 + Math.random() * 20; // ширина формы
      let h = 10 + Math.random() * 20; // высота формы
      groundForms.push({x, y, w, h});
    }


    function updateGroundForms() {
      for (let i = 0; i < groundForms.length; i++) {
        groundForms[i].x -= backgroundSpeed;
        // Если форма вышла за пределы канваса слева, добавляем ее справа
        if (groundForms[i].x + groundForms[i].w < 0) {
          groundForms[i].x = canvas.width;
          groundForms[i].y = groundY + Math.random() * groundHeight / 2;
          groundForms[i].w = 10 + Math.random() * 20;
          groundForms[i].h = 10 + Math.random() * 20;
        }
      }
    }

    function drawGround() {
      ctx.fillStyle = 'green';
      ctx.fillRect(backgroundX, groundY, canvas.width, groundHeight);
      ctx.fillRect(backgroundX + canvas.width, groundY, canvas.width, groundHeight);

      // Рисуем формы на земле
      ctx.fillStyle = 'darkgreen'; // цвет для форм
      for (let i = 0; i < groundForms.length; i++) {
        ctx.fillRect(groundForms[i].x, groundForms[i].y, groundForms[i].w, groundForms[i].h);
      }
    }

    function drawBackground() {
      ctx.fillStyle = '#000';
      ctx.fillRect(backgroundX, 0, canvas.width, groundY);
      ctx.fillRect(backgroundX + canvas.width, 0, canvas.width, groundY);
      drawGround(); // Добавляем землю на фон
    }

    function createEnemy() {
      let enemy = {
        x: canvas.width,
        y: Math.random() * (canvas.height - groundHeight),
        width: 30,
        height: 30,
        speed: enemySpeed
      };
      enemies.push(enemy);
    }

    function drawEnemy(enemy) {
      ctx.fillStyle = 'red';
      ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
    }

    function updateEnemies() {
      for (let i = 0; i < enemies.length; i++) {
        enemies[i].x -= enemies[i].speed;
        // Удаляем врага, если он вышел за пределы канваса
        if (enemies[i].x + enemies[i].width < 0) {
          enemies.splice(i, 1);
          i--;
        }
      }
    }

    function checkBulletEnemyCollision() {
      for (let i = 0; i < bullets.length; i++) {
        for (let j = 0; j < enemies.length; j++) {
          let bullet = bullets[i];
          let enemy = enemies[j];
          if (bullet.x < enemy.x + enemy.width &&
            bullet.x + bullet.width > enemy.x &&
            bullet.y < enemy.y + enemy.height &&
            bullet.y + bullet.height > enemy.y) {
            // Столкновение произошло, удаляем пулю и врага
            bullets.splice(i, 1);
            enemies.splice(j, 1);
            return;
          }
        }
      }
    }

    // Звезды
    const stars = [];
    const starSpeed = 0.5;

    function createStar() {
      let star = {
        x: Math.random() * canvas.width,
        y: Math.random() * (canvas.height - groundHeight),
        radius: Math.random() * 2, // радиус звезды
        speed: starSpeed
      };
      stars.push(star);
    }

    function drawStar(star) {
      ctx.fillStyle = 'white';
      ctx.beginPath();
      ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2, false);
      ctx.fill();
    }

    function updateStars() {
      for (let i = 0; i < stars.length; i++) {
        stars[i].x -= stars[i].speed;
        // Если звезда вышла за пределы канваса слева, добавляем ее справа
        if (stars[i].x + stars[i].radius < 0) {
          stars[i].x = canvas.width;
          stars[i].y = Math.random() * (canvas.height - groundHeight);
        }
      }
    }

    function update() {
      if (ship.moveUp && ship.y > 0) ship.y -= ship.speed;
      if (ship.moveDown && ship.y < canvas.height - ship.height) ship.y += ship.speed;

      updateBackground();
      updateStars(); // Обновляем звезды
      updateBullets();
      updateGroundForms(); // Обновляем формы на земле
      updateEnemies(); // Обновляем врагов
      checkBulletEnemyCollision(); // Проверяем столкновение пуль и врагов
    }

// В функции draw добавляем отрисовку врагов
    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawBackground();
      stars.forEach(drawStar); // Отрисовываем звезды
      drawShip();
      bullets.forEach(drawBullet);
      enemies.forEach(drawEnemy);
    }

// В gameLoop добавляем вызов функции createEnemy каждые 2 секунды
    let lastEnemyCreationTime = Date.now();
    let lastStarCreationTime = Date.now();
    function gameLoop() {
      let now = Date.now();
      if (now - lastEnemyCreationTime > 2000) { // 2000 мс = 2 сек
        createEnemy();
        lastEnemyCreationTime = now;
      }
      if (now - lastStarCreationTime > 100) { // 100 мс
        createStar();
        lastStarCreationTime = now;
      }

      update();
      draw();
      requestAnimationFrame(gameLoop);
    }

    // Обработчики клавиатуры
    document.addEventListener('keydown', function(e) {
      if (e.key === 'ArrowUp') ship.moveUp = true;
      if (e.key === 'ArrowDown') ship.moveDown = true;
      if (e.key === ' ') { // пробел для стрельбы
        bullets.push({ x: ship.x + ship.width, y: ship.y + ship.height / 2, width: 10, height: 5 });
      }
    });

    document.addEventListener('keyup', function(e) {
      if (e.key === 'ArrowUp') ship.moveUp = false;
      if (e.key === 'ArrowDown') ship.moveDown = false;
    });

    gameLoop();
  });



</script>
</body>
</html>
